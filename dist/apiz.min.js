(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b(a["apiz-ng"]={})})(this,function(a){"use strict";function b(a,b,{baseURL:c,paramRegex:d,querystring:e,client:f}){let{url:g,baseURL:h,path:i,method:m="GET",type:o=n,pathParams:p=!1}=b;const q={},r=h||c;if("remove"===a||"add"===a)throw new Error("\"remove\" and \"add\" is preserved key.");if(!j(b))throw new TypeError(`API ${a} expected an object, but received ${JSON.stringify(b)}.`);if(l(g))q.url=g;else if(l(r))q.url=(r+(i||"")).replace(/(?<!:)(\/\/)/g,"/");else throw new Error(`API "${a}" must set url or baseURL correctly.`);m=m.toUpperCase();let s=m.toLowerCase();if(!["GET","HEAD","POST","PUT","PATCH","DELETE","OPTIONS"].includes(m))throw new Error(`Unsupported HTTP method: ${m}.`);if(!k(f[s]))throw new Error(`client must implement a ${s} function.`);return q.method=m,q.methodLowerCase=s,q[s]=f[s],q.type=o,q.pathParams=p,q.regex=d,q.querystring=e,q.init=!0,q}function c(a){return(b,c)=>{if(null==a[c])throw new Error(`Can't find a property "${c}" in params.`);return encodeURIComponent(a[c])}}function d(...a){const{methodLowerCase:b,pathParams:d,regex:e,querystring:f}=this;let g,h,i,j=this.url;if(!0===a[1])return this[b](j,a[0]);if(d?(g=a[0],h=a[1]):h=a[0],g)j=j.replace(e,c(g));else if(d)throw new Error("Path params is required.");return h&&(i=f(h),j=j.includes("?")?`${j}&${i}`:`${j}?${i}`),this[b](j)}function e(...a){const{methodLowerCase:b,type:d,pathParams:e,regex:f,querystring:g}=this;let h,i,j,k,m,n=this.url;if(!0===a[1])return this[b](n,a[0],k,!0);if(e?(h=a[1],i=a[2],k=a[3]||d):(i=a[1],k=a[2]||d),j=a[0],h)n=n.replace(f,c(h));else if(e)throw new Error("Path params is required.");return l(i)&&!i.includes("=")?k=i:i&&(m=g(i),n=n.includes("?")?`${n}&${m}`:`${n}?${m}`),this[b](n,j,k,!1)}function f(a){const b=t[a.method].bind(a);return["url","method","type","pathParams"].forEach(c=>{Object.defineProperty(b,c,{value:a[c],enumerable:!0,writable:!1})}),b}function g(a,c){let d,e,h,i,n,t={};if(l(a._baseURL)&&(d=a._baseURL),({baseURL:d=d,immutableMeta:e=r,paramRegex:h=p||s,querystring:i=o,client:n=q}=c||{}),!k(i))throw new Error("A querystring function must set.");if(!n)throw new Error("A client must set.");const u={baseURL:d,paramRegex:h,querystring:i,client:n};if(e)t=a||{};else for(const c in a)j(a[c])?t[c]=b(c,a[c],u):"_baseURL"!=c&&console.warn(`The ${c} in meta is not an object.`);const v=new Proxy({},{get(a,c,d){if(!t[c]||!m(t,c))return Reflect.get(a,c);t[c].init||(t[c]=b(c,t[c],u));const e=f(t[c]);return Reflect.set(d,c,e),e},getPrototypeOf(){return g.prototype}}),w=Object.create(v);return w.remove=function(a){this[a]&&(t[a]=this[a]=void 0)},w.add=function(a,c){if(t[a])throw new Error(`API "${a}" already exists.`);t[a]=b(a,c,u),this[a]=f(t[a])},w}function h({querystring:a,paramRegex:b,immutableMeta:c,client:d,reset:e,defaultType:f}={reset:!0}){k(a)&&(o=a),b instanceof RegExp&&(p=b),r=c,q=d,n=f,e&&(o=p=q=n=void 0,r=!1)}const i=Map.call.bind(Object.prototype.toString),j=a=>"[object Object]"===i(a),k=a=>"function"==typeof a,l=a=>a&&"string"==typeof a,m=Map.call.bind(Object.prototype.propertyIsEnumerable);let n,o,p,q,r=!1;const s=/(?<=\/):((\w|-)+)/g,t={GET:d,HEAD:d,POST:e,PUT:e,PATCH:e,OPTIONS:d,DELETE:d};h({querystring:function(a){return"[object Object]"===Object.prototype.toString.call(a)?Object.keys(a).map(b=>Array.isArray(a[b])?a[b].map(a=>`${encodeURIComponent(b)}=${encodeURIComponent(a)}`).join("&"):`${encodeURIComponent(b)}=${encodeURIComponent(a[b])}`).join("&"):"string"==typeof a?a:JSON.stringify(a)},defaultType:"json"}),a.APIz=g,a.config=h,Object.defineProperty(a,"__esModule",{value:!0})});
//# sourceMappingURL=apiz.min.js.map

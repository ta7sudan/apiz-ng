{"version":3,"file":"apiz.esm.js","sources":["../src/core.js","../src/querystring.js","../src/index.js"],"sourcesContent":["/* global DEBUG */\nconst toString = Map.call.bind(Object.prototype.toString);\nconst isObj = o => toString(o) === '[object Object]';\nconst isFn = f => typeof f === 'function';\nconst isStr = s => s && typeof s === 'string';\nconst isEnumerable = Map.call.bind(Object.prototype.propertyIsEnumerable);\n\nlet defaultType,\n\tglobalQuerystring,\n\tglobalParamRegex,\n\tglobalClient,\n\tglobalImmutableMeta = false;\n\n// ES2018+, 是讲这个特性没法被babel转译,\n// 那既然都用ES2018了, 不如把能用的特性都用上好了...\nconst defaultParamRegex = /(?<=\\/):((\\w|-)+)/g,\n\tmethodMap = {\n\t\tGET: noBodyRequest,\n\t\tHEAD: noBodyRequest,\n\t\tPOST: bodyRequest,\n\t\tPUT: bodyRequest,\n\t\tPATCH: bodyRequest,\n\t\t// 尽管浏览器支持OPTIONS和DELETE带body, 但是考虑到不常用,\n\t\t// 还是默认它们不带body, 如果需要的话, 可以直接开启完整选项加入body\n\t\t// 有空改成可配置吧\n\t\tOPTIONS: noBodyRequest,\n\t\tDELETE: noBodyRequest\n\t};\n\nfunction parseApiInfo(\n\tname,\n\trawInfo,\n\t{ baseURL: gBaseURL, paramRegex, querystring, client }\n) {\n\tlet { url, baseURL, path, method = 'GET', type = defaultType, pathParams = false } = rawInfo;\n\tconst info = {},\n\t\tbURL = baseURL || gBaseURL;\n\n\tif (name === 'remove' || name === 'add') {\n\t\tthrow new Error('\"remove\" and \"add\" is preserved key.');\n\t}\n\tif (!isObj(rawInfo)) {\n\t\tthrow new TypeError(`API ${name} expected an object, but received ${JSON.stringify(rawInfo)}.`);\n\t}\n\tif (isStr(url)) {\n\t\tinfo.url = url;\n\t} else if (isStr(bURL)) {\n\t\tinfo.url = (bURL + (path || '')).replace(/(?<!:)(\\/\\/)/g, '/');\n\t} else {\n\t\tthrow new Error(`API \"${name}\" must set url or baseURL correctly.`);\n\t}\n\tmethod = method.toUpperCase();\n\tlet methodLowerCase = method.toLowerCase();\n\tif (!['GET', 'HEAD', 'POST', 'PUT', 'PATCH', 'DELETE', 'OPTIONS'].includes(method)) {\n\t\tthrow new Error(`Unsupported HTTP method: ${method}.`);\n\t}\n\tif (!isFn(client[methodLowerCase])) {\n\t\tthrow new Error(`client must implement a ${methodLowerCase} function.`);\n\t}\n\tinfo.method = method;\n\tinfo.methodLowerCase = methodLowerCase;\n\tinfo[methodLowerCase] = client[methodLowerCase];\n\tinfo.type = type;\n\tinfo.pathParams = pathParams;\n\tinfo.regex = paramRegex;\n\tinfo.querystring = querystring;\n\tinfo.init = true;\n\treturn info;\n}\n\nfunction replaceParams(params) {\n\treturn (m, v) => {\n\t\tif (params[v] == null) {\n\t\t\tthrow new Error(`Can't find a property \"${v}\" in params.`);\n\t\t}\n\t\treturn encodeURIComponent(params[v]);\n\t};\n}\n\n// 其实noBodyRequest和bodyRequest我们可以合并成一个,\n// 因为我们已经知道method了, 也就可以知道它是否会带body,\n// 但是考虑到让代码更加清晰一点, 还是拆成两个吧, 这点\n// 代码重复算是可以接受. 另一方面讲, 其实也可以让接口只\n// 实现一个request方法就好, 而不用对每个HTTP方法都实现一个\n// 对应的方法, 因为我们也可以把method传过去\nfunction noBodyRequest(...args) {\n\tconst { methodLowerCase, pathParams, regex, querystring } = this;\n\tlet params, query, qs, url = this.url;\n\tif (args[1] === true) {\n\t\t// 接口处记得检测对象是否为空\n\t\treturn this[methodLowerCase](url, args[0]);\n\t} else if (pathParams) {\n\t\tparams = args[0];\n\t\tquery = args[1];\n\t} else {\n\t\tquery = args[0];\n\t}\n\n\tif (params) {\n\t\turl = url.replace(regex, replaceParams(params));\n\t} else if (pathParams) {\n\t\tthrow new Error('Path params is required.');\n\t}\n\n\tif (query) {\n\t\tqs = querystring(query);\n\t\turl = url.includes('?') ? `${url}&${qs}` : `${url}?${qs}`;\n\t}\n\treturn this[methodLowerCase](url);\n}\n\nfunction bodyRequest(...args) {\n\tconst { methodLowerCase, type: defaultType, pathParams, regex, querystring } = this;\n\tlet params, query, body, type, qs, url = this.url;\n\tif (args[1] === true) {\n\t\treturn this[methodLowerCase](url, args[0], type, true);\n\t} else if (pathParams) {\n\t\tparams = args[1];\n\t\tquery = args[2];\n\t\ttype = args[3] || defaultType;\n\t} else {\n\t\tquery = args[1];\n\t\ttype = args[2] || defaultType;\n\t}\n\tbody = args[0];\n\n\tif (params) {\n\t\turl = url.replace(regex, replaceParams(params));\n\t} else if (pathParams) {\n\t\tthrow new Error('Path params is required.');\n\t}\n\n\t// 这里实际上会造成带body的query的集合和不带body的query的集合不一致,\n\t// 不过考虑实际情况这样的不一致也是可以接受\n\tif (isStr(query) && !query.includes('=')) {\n\t\ttype = query;\n\t} else if (query) {\n\t\tqs = querystring(query);\n\t\turl = url.includes('?') ? `${url}&${qs}` : `${url}?${qs}`;\n\t}\n\treturn this[methodLowerCase](url, body, type, false);\n}\n\nfunction createAPI(info) {\n\tconst fn = methodMap[info.method].bind(info);\n\t['url', 'method', 'type', 'pathParams'].forEach(k => {\n\t\tObject.defineProperty(fn, k, {\n\t\t\tvalue: info[k],\n\t\t\tenumerable: true,\n\t\t\twritable: false\n\t\t});\n\t});\n\treturn fn;\n}\n\n// 别问, 就是不喜欢ES6 class\nfunction APIz(apiMeta, options) {\n\tlet baseURL,\n\t\timmutableMeta,\n\t\tparamRegex,\n\t\tquerystring,\n\t\tclient,\n\t\tmeta = {};\n\n\tisStr(apiMeta._baseURL) && (baseURL = apiMeta._baseURL);\n\n\t({\n\t\tbaseURL = baseURL,\n\t\timmutableMeta = globalImmutableMeta,\n\t\tparamRegex = globalParamRegex || defaultParamRegex,\n\t\tquerystring = globalQuerystring,\n\t\tclient = globalClient\n\t} = options || {});\n\n\tif (!isFn(querystring)) {\n\t\tthrow new Error('A querystring function must set.');\n\t}\n\n\tif (!client) {\n\t\tthrow new Error('A client must set.');\n\t}\n\n\tconst groupOptions = {\n\t\tbaseURL,\n\t\tparamRegex,\n\t\tquerystring,\n\t\tclient\n\t};\n\n\tif (immutableMeta) {\n\t\tmeta = apiMeta || {};\n\t} else {\n\t\t// 不用Object.keys, 允许配置对象继承\n\t\tfor (const key in apiMeta) {\n\t\t\tif (isObj(apiMeta[key])) {\n\t\t\t\tmeta[key] = parseApiInfo(key, apiMeta[key], groupOptions);\n\t\t\t} else if (key !== '_baseURL') {\n\t\t\t\tconsole.warn(`The ${key} in meta is not an object.`);\n\t\t\t}\n\t\t}\n\t}\n\n\tconst pxy = new Proxy({}, {\n\t\tget(target, key, receiver) {\n\t\t\tif (!meta[key] || !isEnumerable(meta, key)) {\n\t\t\t\treturn Reflect.get(target, key);\n\t\t\t} else if (!meta[key].init) {\n\t\t\t\tmeta[key] = parseApiInfo(key, meta[key], groupOptions);\n\t\t\t}\n\t\t\tconst apiFn = createAPI(meta[key]);\n\t\t\tReflect.set(receiver, key, apiFn);\n\t\t\treturn apiFn;\n\t\t},\n\t\tgetPrototypeOf() {\n\t\t\treturn APIz.prototype;\n\t\t}\n\t});\n\n\tconst self = Object.create(pxy);\n\tself.remove = function (name) {\n\t\tthis[name] && (meta[name] = this[name] = undefined);\n\t};\n\tself.add = function (name, apiInfo) {\n\t\tif (meta[name]) {\n\t\t\tthrow new Error(`API \"${name}\" already exists.`);\n\t\t}\n\t\tmeta[name] = parseApiInfo(name, apiInfo, groupOptions);\n\t\tthis[name] = createAPI(meta[name]);\n\t};\n\treturn self;\n}\n\nexport { APIz };\n\nexport function config({ querystring, paramRegex, immutableMeta, client, reset, defaultType: dt } = { reset: true }) {\n\tisFn(querystring) && (globalQuerystring = querystring);\n\tparamRegex instanceof RegExp && (globalParamRegex = paramRegex);\n\tglobalImmutableMeta = immutableMeta;\n\tglobalClient = client;\n\tdefaultType = dt;\n\treset && (globalQuerystring = globalParamRegex = globalClient = defaultType = undefined, globalImmutableMeta = false);\n}\n","export function querystring(obj) {\n\tif (Object.prototype.toString.call(obj) === '[object Object]') {\n\t\treturn Object.keys(obj)\n\t\t\t.map(\n\t\t\t\tk =>\n\t\t\t\t\tArray.isArray(obj[k])\n\t\t\t\t\t\t? obj[k]\n\t\t\t\t\t\t\t.map(v => `${encodeURIComponent(k)}=${encodeURIComponent(v)}`)\n\t\t\t\t\t\t\t.join('&')\n\t\t\t\t\t\t: `${encodeURIComponent(k)}=${encodeURIComponent(obj[k])}`\n\t\t\t)\n\t\t\t.join('&');\n\t} else if (typeof obj === 'string') {\n\t\treturn obj;\n\t} else {\n\t\treturn JSON.stringify(obj);\n\t}\n}","import { config } from './core';\nimport { querystring } from './querystring';\n\nconfig({\n\tquerystring,\n\tdefaultType: 'json'\n});\n\nexport * from './core';"],"names":["toString","Map","call","bind","Object","prototype","isObj","o","isFn","f","isStr","s","isEnumerable","propertyIsEnumerable","defaultType","globalQuerystring","globalParamRegex","globalClient","globalImmutableMeta","defaultParamRegex","methodMap","GET","noBodyRequest","HEAD","POST","bodyRequest","PUT","PATCH","OPTIONS","DELETE","parseApiInfo","name","rawInfo","baseURL","gBaseURL","paramRegex","querystring","client","url","path","method","type","pathParams","info","bURL","Error","TypeError","JSON","stringify","replace","toUpperCase","methodLowerCase","toLowerCase","includes","regex","init","replaceParams","params","m","v","encodeURIComponent","args","query","qs","body","createAPI","fn","forEach","k","defineProperty","value","enumerable","writable","APIz","apiMeta","options","immutableMeta","meta","_baseURL","groupOptions","key","console","warn","pxy","Proxy","get","target","receiver","Reflect","apiFn","set","getPrototypeOf","self","create","remove","undefined","add","apiInfo","config","reset","dt","RegExp","obj","keys","map","Array","isArray","join"],"mappings":"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"}